<?php
require 'vendor/autoload.php';

use PhpOffice\PhpSpreadsheet\Spreadsheet;
use PhpOffice\PhpSpreadsheet\Writer\Xlsx;
use PhpOffice\PhpSpreadsheet\Style\Alignment;
use PhpOffice\PhpSpreadsheet\Style\Border;
use PhpOffice\PhpSpreadsheet\Style\Fill;

// Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Spreadsheet
$spreadsheet = new Spreadsheet();
$sheet = $spreadsheet->getActiveSheet();

// Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸ (ÑÑ‚Ñ€Ğ¾ĞºĞ° 1)
$headers = [
    'A1' => 'last_name',
    'B1' => 'first_name', 
    'C1' => 'patronymic',
    'D1' => 'birth_date',
    'E1' => 'region',
    'F1' => 'passport_series',
    'G1' => 'passport_number',
    'H1' => 'passport_date',
    'I1' => 'vehicle_number',
    'J1' => 'cadastral_number',
    'K1' => 'property_type'
];

foreach ($headers as $cell => $value) {
    $sheet->setCellValue($cell, $value);
}

// Ğ¡Ğ¢Ğ˜Ğ›Ğ˜ Ğ´Ğ»Ñ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¾Ğ²
$sheet->getStyle('A1:K1')->applyFromArray([
    'font' => [
        'bold' => true,
        'color' => ['rgb' => 'FFFFFF']
    ],
    'fill' => [
        'fillType' => Fill::FILL_SOLID,
        'startColor' => ['rgb' => '4472C4']
    ],
    'borders' => [
        'allBorders' => [
            'borderStyle' => Border::BORDER_THIN,
            'color' => ['rgb' => '000000']
        ]
    ],
    'alignment' => [
        'horizontal' => Alignment::HORIZONTAL_CENTER,
        'vertical' => Alignment::VERTICAL_CENTER
    ]
]);

// ============= Ğ”ĞĞĞĞ«Ğ• Ğ”Ğ›Ğ¯ Ğ¢Ğ•Ğ¡Ğ¢Ğ =============

// 1. Ğ˜Ğ’ĞĞĞĞ’ - Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡ĞµÑ‚ (CL:Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ V1)
$sheet->setCellValue('A2', 'Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²');
$sheet->setCellValue('B2', 'Ğ˜Ğ²Ğ°Ğ½');
$sheet->setCellValue('C2', 'Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‡');
$sheet->setCellValue('D2', '1985-05-15');
$sheet->setCellValue('E2', 'ĞœĞ¾ÑĞºĞ²Ğ°');

// 2. ĞŸĞ•Ğ¢Ğ ĞĞ’ - Ğ¿Ğ°ÑĞ¿Ğ¾Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡ĞµÑ‚ (CL:ĞŸĞ°ÑĞ¿Ğ¾Ñ€Ñ‚ V1)
$sheet->setCellValue('A3', 'ĞŸĞµÑ‚Ñ€Ğ¾Ğ²');
$sheet->setCellValue('B3', 'ĞŸĞµÑ‚Ñ€');
$sheet->setCellValue('C3', 'ĞŸĞµÑ‚Ñ€Ğ¾Ğ²Ğ¸Ñ‡');
$sheet->setCellValue('D3', '1990-10-20');
$sheet->setCellValue('E3', 'Ğ¡Ğ°Ğ½ĞºÑ‚-ĞŸĞµÑ‚ĞµÑ€Ğ±ÑƒÑ€Ğ³');
$sheet->setCellValue('F3', '4500');
$sheet->setCellValue('G3', '123456');
$sheet->setCellValue('H3', '2015-03-10');

// 3. Ğ¡Ğ˜Ğ”ĞĞ ĞĞ’ - Ğ°Ğ²Ñ‚Ğ¾Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ (AI:ĞĞ²Ñ‚Ğ¾Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ V1)
$sheet->setCellValue('A4', 'Ğ¡Ğ¸Ğ´Ğ¾Ñ€Ğ¾Ğ²');
$sheet->setCellValue('B4', 'Ğ¡Ğ¸Ğ´Ğ¾Ñ€');
$sheet->setCellValue('C4', 'Ğ¡Ğ¸Ğ´Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ‡');
$sheet->setCellValue('I4', 'Ğ123Ğ’Ğ¡77');

// 4. Ğ¡ĞœĞ˜Ğ ĞĞĞ’Ğ - Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ (CL:ĞĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ)
$sheet->setCellValue('A5', 'Ğ¡Ğ¼Ğ¸Ñ€Ğ½Ğ¾Ğ²Ğ°');
$sheet->setCellValue('B5', 'ĞĞ½Ğ½Ğ°');
$sheet->setCellValue('C5', 'Ğ¡ĞµÑ€Ğ³ĞµĞµĞ²Ğ½Ğ°');
$sheet->setCellValue('J5', '77:01:0001001:1234');
$sheet->setCellValue('K5', 'land');

// 5. ĞšĞ£Ğ—ĞĞ•Ğ¦ĞĞ’ - Ğ²ÑĞµ Ñ‚Ğ¸Ğ¿Ñ‹ ÑÑ€Ğ°Ğ·Ñƒ (Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ)
$sheet->setCellValue('A6', 'ĞšÑƒĞ·Ğ½ĞµÑ†Ğ¾Ğ²');
$sheet->setCellValue('B6', 'Ğ”Ğ¼Ğ¸Ñ‚Ñ€Ğ¸Ğ¹');
$sheet->setCellValue('C6', 'ĞĞ»ĞµĞºÑĞµĞµĞ²Ğ¸Ñ‡');
$sheet->setCellValue('D6', '1988-12-01');
$sheet->setCellValue('E6', 'Ğ•ĞºĞ°Ñ‚ĞµÑ€Ğ¸Ğ½Ğ±ÑƒÑ€Ğ³');
$sheet->setCellValue('F6', '4501');
$sheet->setCellValue('G6', '654321');
$sheet->setCellValue('H6', '2016-06-15');
$sheet->setCellValue('I6', 'Ğ’123ĞœĞ96');
$sheet->setCellValue('J6', '66:01:0002002:5678');
$sheet->setCellValue('K6', 'building');

// 6. ĞŸĞĞŸĞĞ’ - Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ + Ğ¿Ğ°ÑĞ¿Ğ¾Ñ€Ñ‚
$sheet->setCellValue('A7', 'ĞŸĞ¾Ğ¿Ğ¾Ğ²');
$sheet->setCellValue('B7', 'ĞĞ½Ğ´Ñ€ĞµĞ¹');
$sheet->setCellValue('C7', 'Ğ’Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²Ğ¸Ñ‡');
$sheet->setCellValue('D7', '1979-03-22');
$sheet->setCellValue('E7', 'ĞĞ¾Ğ²Ğ¾ÑĞ¸Ğ±Ğ¸Ñ€ÑĞº');
$sheet->setCellValue('F7', '4502');
$sheet->setCellValue('G7', '789012');
$sheet->setCellValue('H7', '2010-09-05');

// 7. Ğ¡ĞĞšĞĞ›ĞĞ’Ğ - Ğ°Ğ²Ñ‚Ğ¾ + Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ
$sheet->setCellValue('A8', 'Ğ¡Ğ¾ĞºĞ¾Ğ»Ğ¾Ğ²Ğ°');
$sheet->setCellValue('B8', 'Ğ•Ğ»ĞµĞ½Ğ°');
$sheet->setCellValue('C8', 'Ğ˜Ğ³Ğ¾Ñ€ĞµĞ²Ğ½Ğ°');
$sheet->setCellValue('I8', 'Ğš456Ğ¥Ğ¥178');
$sheet->setCellValue('J8', '78:02:0003003:9012');
$sheet->setCellValue('K8', 'premises');

// 8. Ğ›Ğ•Ğ‘Ğ•Ğ”Ğ•Ğ’ - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ğ°ÑĞ¿Ğ¾Ñ€Ñ‚ (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼)
$sheet->setCellValue('A9', 'Ğ›ĞµĞ±ĞµĞ´ĞµĞ²');
$sheet->setCellValue('B9', 'ĞœĞ°ĞºÑĞ¸Ğ¼');
$sheet->setCellValue('F9', '4503');
$sheet->setCellValue('G9', '345678');

// 9. ĞĞ˜ĞšĞĞ›ĞĞ•Ğ’Ğ - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ
$sheet->setCellValue('A10', 'ĞĞ¸ĞºĞ¾Ğ»Ğ°ĞµĞ²Ğ°');
$sheet->setCellValue('B10', 'ĞĞ»ÑŒĞ³Ğ°');
$sheet->setCellValue('J10', '50:03:0004004:1122');
$sheet->setCellValue('K10', 'land');

// 10. Ğ¢Ğ•Ğ¡Ğ¢ĞĞ’ - Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ† (Ğ¿ÑƒÑÑ‚Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ)
$sheet->setCellValue('A11', 'Ğ¢ĞµÑÑ‚Ğ¾Ğ²');
$sheet->setCellValue('B11', 'Ğ¢ĞµÑÑ‚');
$sheet->setCellValue('I11', ''); // Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ¢Ğ¡ - Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ±Ñ‹Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°
$sheet->setCellValue('J11', ''); // Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ ĞºĞ°Ğ´Ğ°ÑÑ‚Ñ€ - Ğ¾ÑˆĞ¸Ğ±ĞºĞ°

// ============= Ğ¤ĞĞ ĞœĞĞ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• =============

// ĞĞ²Ñ‚Ğ¾ÑˆĞ¸Ñ€Ğ¸Ğ½Ğ° ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¾Ğº
foreach (range('A', 'K') as $col) {
    $sheet->getColumnDimension($col)->setAutoSize(true);
}

// Ğ¡Ñ‚Ğ¸Ğ»Ğ¸ Ğ´Ğ»Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
$sheet->getStyle('A2:K11')->applyFromArray([
    'borders' => [
        'allBorders' => [
            'borderStyle' => Border::BORDER_THIN,
            'color' => ['rgb' => 'CCCCCC']
        ]
    ],
    'alignment' => [
        'vertical' => Alignment::VERTICAL_CENTER
    ]
]);

// Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ´Ğ°Ñ‚Ñ‹ Ğ´Ğ»Ñ ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¾Ğº D Ğ¸ H
$sheet->getStyle('D2:D11')->getNumberFormat()->setFormatCode('yyyy-mm-dd');
$sheet->getStyle('H2:H11')->getNumberFormat()->setFormatCode('yyyy-mm-dd');

// ĞŸĞ¾Ğ´ÑĞ²ĞµÑ‚ĞºĞ° Ğ¿ÑƒÑÑ‚Ñ‹Ñ… Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ĞµĞ¹ (Ğ´Ğ»Ñ Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸)
$sheet->getStyle('I11')->getFill()
    ->setFillType(Fill::FILL_SOLID)
    ->getStartColor()->setRGB('FFC7CE');
$sheet->getStyle('J11')->getFill()
    ->setFillType(Fill::FILL_SOLID)
    ->getStartColor()->setRGB('FFC7CE');

// Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ»Ğ¸ÑÑ‚ Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸ĞµĞ¹
$spreadsheet->createSheet();
$spreadsheet->setActiveSheetIndex(1);
$instructionSheet = $spreadsheet->getActiveSheet();
$instructionSheet->setTitle('Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ');

$instructionSheet->setCellValue('A1', 'Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞšĞ¦Ğ˜Ğ¯ ĞŸĞ Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ® ĞœĞĞ¡Ğ¡ĞĞ’ĞĞ™ Ğ—ĞĞ“Ğ Ğ£Ğ—ĞšĞ˜');
$instructionSheet->getStyle('A1')->getFont()->setBold(true)->setSize(14);

$instructionSheet->setCellValue('A3', '1. Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ²:');
$instructionSheet->setCellValue('A4', '   - Ğ”Ğ»Ñ ÑÑ‚Ñ€Ğ¾Ğº 2-3: Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ "CL:Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ V1"');
$instructionSheet->setCellValue('A5', '   - Ğ”Ğ»Ñ ÑÑ‚Ñ€Ğ¾Ğº 3,6,7: Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ "CL:ĞŸĞ°ÑĞ¿Ğ¾Ñ€Ñ‚ V1"');
$instructionSheet->setCellValue('A6', '   - Ğ”Ğ»Ñ ÑÑ‚Ñ€Ğ¾Ğº 4,6,8: Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ "AI:ĞĞ²Ñ‚Ğ¾Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ V1"');
$instructionSheet->setCellValue('A7', '   - Ğ”Ğ»Ñ ÑÑ‚Ñ€Ğ¾Ğº 5,6,8,10: Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ "CL:ĞĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ"');

$instructionSheet->setCellValue('A9', '2. Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ» Ğ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿Ñ€ĞµĞ´Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€');

$instructionSheet->setCellValue('A11', '3. ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ"');

$instructionSheet->setCellValue('A13', 'ĞĞ–Ğ˜Ğ”ĞĞ•ĞœĞ«Ğ™ Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢:');
$instructionSheet->setCellValue('A14', 'âœ“ Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ¸ 1-10: ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ¾Ğ² (ĞºÑ€Ğ¾Ğ¼Ğµ Ğ¿ÑƒÑÑ‚Ñ‹Ñ… Ğ¿Ğ¾Ğ»ĞµĞ¹)');
$instructionSheet->setCellValue('A15', 'âœ— Ğ¡Ñ‚Ñ€Ğ¾ĞºĞ° 11: Ğ¾ÑˆĞ¸Ğ±ĞºĞ° - Ğ¿ÑƒÑÑ‚Ñ‹Ğµ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ');

$instructionSheet->getColumnDimension('A')->setAutoSize(true);

// Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ÑÑ Ğ½Ğ° Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ»Ğ¸ÑÑ‚
$spreadsheet->setActiveSheetIndex(0);
$sheet->setTitle('Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ');

// Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ñ„Ğ°Ğ¹Ğ»
$writer = new Xlsx($spreadsheet);
$writer->save('test_reports.xlsx');

echo "âœ… Ğ¤Ğ°Ğ¹Ğ» test_reports.xlsx ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ½!\n";
echo "ğŸ“ ĞŸÑƒÑ‚ÑŒ: " . realpath('test_reports.xlsx') . "\n";